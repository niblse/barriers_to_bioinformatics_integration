geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.3, size = 5, color = "black", nudge_x = .1)+
#scale_x_discrete(breaks = NULL)+
#guides(fill=guide_legend(ncol=3))+
theme(axis.line = element_line(colour = "black"))+
scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues: Expertise/training",
"Student Issues: Lack of background skills/knowledge",
"Facilities Issues: Access to computer labs",
"Faculty Issues: Time",
"Resource Issues",
"Institutional Issues: Access to IT support",
"Curriculum Issues: No space",
"Student Issues: Lack of interest",
"Curriculum Issues: Lack of integration",
"Curriculum Issues: Too much content",
"Resource Issues: Access to high-performance computing"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =5))
#ggsave( filename= "scored_barriers_Q06_Q29_Q33_Q38_BW.png",
#        width = 14.8,
#        height = 8.81,
#        units = "in")
# Order plot by percentages
total.scored.cols <- total.scored.cols%>%
group_by(question)%>%
arrange(.,desc(percentage))
total.scored.cols%>%
filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.score)+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.3, size = 5, color = "black", nudge_x = .1)+
#scale_x_discrete(breaks = NULL)+
#guides(fill=guide_legend(ncol=3))+
theme(axis.line = element_line(colour = "black"))+
#  scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
#                                                                                "Student Issues",
#                                                                                "Curriculum Issues",
#                                                                                "Facilities Issues",
#                                                                                "Resource Issues",
#                                                                                "Institutional Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =5))
#ggsave( filename= "scored_barriers_Q06_Q29_Q33_Q38_color.png",
#        width = 14.8,
#        height = 8.81,
#        units = "in")
View(total.reduced.cols)
View(total.reduced.cols)
View(total.reduced.cols)
View(total.scored.cols)
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 6, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
"Student Issues",
"Curriculum Issues",
"Facilities Issues",
"Resource Issues",
"Institutional Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 6, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
"Student Issues",
"Curriculum Issues",
"Facilities Issues",
"Resource Issues",
"Institutional Issues"
"State Issues"
"Accrediation Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
ggsave( filename= "supfig_01_bw.png",
width = 13.8,
height = 8.81,
units = "in")
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 6, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
"Student Issues",
"Curriculum Issues",
"Facilities Issues",
"Resource Issues",
"Institutional Issues",
"State Issues",
"Accrediation Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
ggsave( filename= "supfig_01_bw.png",
width = 13.8,
height = 8.81,
units = "in")
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 4, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
"Student Issues",
"Curriculum Issues",
"Facilities Issues",
"Resource Issues",
"Institutional Issues",
"State Issues",
"Accrediation Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
ggsave( filename= "supfig_01_bw.png",
width = 13.8,
height = 8.81,
units = "in")
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 6, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
#scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
#                                                                              "Student Issues",
#                                                                              "Curriculum Issues",
#                                                                              "Facilities Issues",
#                                                                              "Resource Issues",
#                                                                              "Institutional Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
ggsave( filename= "supfig_01_color.png",
width = 13.8,
height = 8.81,
units = "in")
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 4, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
#scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
#                                                                              "Student Issues",
#                                                                              "Curriculum Issues",
#                                                                              "Facilities Issues",
#                                                                              "Resource Issues",
#                                                                              "Institutional Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
ggsave( filename= "supfig_01_color.png",
width = 13.8,
height = 8.81,
units = "in")
total.reduced.cols%>%
group_by(question)%>%
summarise(sum(percentage))
total.reduced.cols%>%
group_by(question)%>%
summarise(100-sum(percentage))
total.reduced.cols%>%
group_by(question)%>%
summarise(1-sum(percentage))
no.responses.cols <- total.reduced.cols%>%
group_by(question)%>%
summarise(1-sum(percentage))
View(no.responses.cols)
rbind(total.reduced.cols, c("a","b","c"))
View(total.reduced.cols)
total.reduced.cols%>%
add_row(percentage=no.responses.cols[1,2], question=no.responses.cols[1,1], barrier="No response")
total.reduced.cols%>%
ungroup()%>%
add_row(percentage=no.responses.cols[1,2], question=no.responses.cols[1,1], barrier="No response")
no.responses.cols[1,2]
no.responses.cols[[1,2]]
total.reduced.cols%>%
ungroup()%>%
add_row(percentage=no.responses.cols[[1,2]], question=no.responses.cols[[1,1]], barrier="No response")
tmp <- total.reduced.cols%>%
ungroup()%>%
add_row(percentage=no.responses.cols[[1,2]], question=no.responses.cols[[1,1]], barrier="No response")
View(tmp)
tmp <- total.reduced.cols%>%
ungroup()%>%
add_row(percentage=no.responses.cols[[1,2]], question=no.responses.cols[[1,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[2,2]], question=no.responses.cols[[2,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[3,2]], question=no.responses.cols[[3,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[4,2]], question=no.responses.cols[[4,1]], barrier="No response")
group_by(question)
tmp <- total.reduced.cols%>%
ungroup()%>%
add_row(percentage=no.responses.cols[[1,2]], question=no.responses.cols[[1,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[2,2]], question=no.responses.cols[[2,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[3,2]], question=no.responses.cols[[3,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[4,2]], question=no.responses.cols[[4,1]], barrier="No response")%>%
group_by(question)
View(tmp)
total.reduced.cols <- total.reduced.cols%>%
ungroup()%>%
add_row(percentage=no.responses.cols[[1,2]], question=no.responses.cols[[1,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[2,2]], question=no.responses.cols[[2,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[3,2]], question=no.responses.cols[[3,1]], barrier="No response")%>%
add_row(percentage=no.responses.cols[[4,2]], question=no.responses.cols[[4,1]], barrier="No response")%>%
group_by(question)
greys <- c("#000000",
"#708090",
"#696969",
"#C0C0C0",
"#d9d9d9",
"#ffffff")
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 4, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
"Student Issues",
"Curriculum Issues",
"Facilities Issues",
"Resource Issues",
"Institutional Issues",
"State Issues",
"Accrediation Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
ggsave( filename= "supfig_01_bw.png",
width = 13.8,
height = 8.81,
units = "in")
total.reduced.cols%>%
#filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.reduce, space = "free_x" )+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.2, size = 4, color = "black")+
#scale_x_discrete(breaks = NULL)+
guides(fill=guide_legend(ncol=2))+
theme(axis.line = element_line(colour = "black"))+
#scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
#                                                                              "Student Issues",
#                                                                              "Curriculum Issues",
#                                                                              "Facilities Issues",
#                                                                              "Resource Issues",
#                                                                              "Institutional Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =2))
ggsave( filename= "supfig_01_color.png",
width = 13.8,
height = 8.81,
units = "in")
#write_csv(total.reduced.cols, "./top5_plots/ouput_tables/reduced_values.csv")
total.scored.cols <- total.scored.cols%>%
group_by(question)%>%
arrange(.,desc(percentage))
greys <- c("#000000",
"#2F4F4F",
"#708090",
"#778899",
"#808080",
"#696969",
"#A9A9A9",
"#C0C0C0",
"#D3D3D3",
"#DCDCDC",
"#ffffff")
total.scored.cols%>%
filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.score)+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.3, size = 5, color = "black", nudge_x = .1)+
#scale_x_discrete(breaks = NULL)+
#guides(fill=guide_legend(ncol=3))+
theme(axis.line = element_line(colour = "black"))+
scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues: Expertise/training",
"Student Issues: Lack of background skills/knowledge",
"Facilities Issues: Access to computer labs",
"Faculty Issues: Time",
"Resource Issues",
"Institutional Issues: Access to IT support",
"Curriculum Issues: No space",
"Student Issues: Lack of interest",
"Curriculum Issues: Lack of integration",
"Curriculum Issues: Too much content",
"Resource Issues: Access to high-performance computing"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =5))
#ggsave( filename= "scored_barriers_Q06_Q29_Q33_Q38_BW.png",
#        width = 14.8,
#        height = 8.81,
#        units = "in")
# Order plot by percentages
total.scored.cols <- total.scored.cols%>%
group_by(question)%>%
arrange(.,desc(percentage))
total.scored.cols%>%
filter(percentage >= 0.05)%>%
ggplot()+
aes(x = barrier, y=percentage, fill = barrier)+
geom_bar(stat = "identity", position = "dodge")+
facet_grid(~ question, labeller = facet_labeller.score)+
xlab("Scored barrier categories")+
ylab("Percentage of respondents reporting barrier")+
scale_fill_discrete(name="Barrier categories")+
theme_fivethirtyeight(base_size = 20, base_family = "sans")+
#theme(panel.background = element_rect(fill = "white"))+
theme(plot.background = element_rect(fill = "white"))+
theme(legend.background = element_rect(fill = "white"))+
#theme(strip.text.y = element_blank())+
#theme(strip.background = element_blank(),strip.text.x = element_blank())+
theme(axis.text.x = element_blank())+
theme(axis.text.y = element_blank())+
theme(legend.key.size = unit(1.5, 'lines'))+
geom_text(aes(label = paste0(round(percentage *100), "%"), y = percentage),
vjust =-.3, size = 5, color = "black", nudge_x = .1)+
#scale_x_discrete(breaks = NULL)+
#guides(fill=guide_legend(ncol=3))+
theme(axis.line = element_line(colour = "black"))+
#  scale_fill_manual(values = greys, name= "Barrier Super-categories", labels= c("Faculty Issues",
#                                                                                "Student Issues",
#                                                                                "Curriculum Issues",
#                                                                                "Facilities Issues",
#                                                                                "Resource Issues",
#                                                                                "Institutional Issues"))+
theme(panel.grid.major=element_blank(),
panel.grid.minor=element_blank())+
guides(fill=guide_legend(nrow =5))
#ggsave( filename= "scored_barriers_Q06_Q29_Q33_Q38_color.png",
#        width = 14.8,
#        height = 8.81,
#        units = "in")
